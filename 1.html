<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <title>선사 예술가</title>
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, user-scalable=no"
    />

    <style>
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      html,
      body {
        width: 100%;
        height: 100%;
        overflow: hidden;
        background: #000;
      }

      .slider {
        position: relative;
        width: 100vw;
        height: 100vh;
        overflow: hidden;
        touch-action: none; /* 브라우저 기본 스와이프 제스처 막기 */
      }

      .slides {
        display: flex;
        width: 100%;
        height: 100%;
        transition: transform 0.35s ease;
      }

      .slide {
        flex: 0 0 100%;
        width: 100vw;
        height: 100vh;
        display: flex;
        align-items: center;
        justify-content: center;
        background: #000;
      }

      .slide img {
        max-height: 100vh;
        width: auto;
        object-fit: contain;
        display: block;
        pointer-events: none; /* 이미지 위에서도 슬라이드 제스처가 먹도록 */
      }

      .indicator {
        position: absolute;
        left: 50%;
        bottom: 16px;
        transform: translateX(-50%);
        color: #fff;
        font-size: 14px;
        background: rgba(0, 0, 0, 0.4);
        padding: 4px 10px;
        border-radius: 20px;
        font-family: system-ui, -apple-system, BlinkMacSystemFont,
          "Noto Sans KR", sans-serif;
      }
    </style>
  </head>
  <body>
    <div class="slider" id="slider">
      <div class="slides" id="slides">
        <!-- JS에서 슬라이드 생성 -->
      </div>
      <div class="indicator" id="indicator">1 / 1</div>
    </div>

    <script>
      // ===== 설정 부분 =====
      const imageCount = 5; // 각 페이지당 이미지 개수 (필요시 수정)

      // 현재 페이지 파일 이름 (예: "/1.html" -> "1.html")
      const fileName = window.location.pathname.split("/").pop();
      // "1.html" -> 1, "2.html" -> 2
      const baseNumber = parseInt(fileName, 10);
      // 혹시 이름이 숫자로 안 시작하면 기본값 1
      const pagePrefixNumber = isNaN(baseNumber) ? 1 : baseNumber;

      const imageFolder = "images";
      const imagePrefix = `${pagePrefixNumber}_`; // "1_" 또는 "2_" 같은 형식
      const imageExt = ".jpg";

      const slidesContainer = document.getElementById("slides");
      const indicator = document.getElementById("indicator");

      // 이미지 목록 생성
      const images = [];
      for (let i = 1; i <= imageCount; i++) {
        images.push(`${imageFolder}/${imagePrefix}${i}${imageExt}`);
      }

      // 슬라이드 DOM 생성
      images.forEach((src) => {
        const slide = document.createElement("div");
        slide.className = "slide";

        const img = document.createElement("img");
        img.src = src;
        img.alt = src;

        slide.appendChild(img);
        slidesContainer.appendChild(slide);
      });

      let currentIndex = 0;
      const total = images.length;

      function updateSlide() {
        const offset = -currentIndex * 100;
        slidesContainer.style.transform = `translateX(${offset}vw)`;
        indicator.textContent = `${currentIndex + 1} / ${total}`;
      }

      updateSlide();

      // ===== 터치 스와이프 처리 =====
      const slider = document.getElementById("slider");
      let startX = 0;
      let isDragging = false;

      const SWIPE_THRESHOLD = 50;

      slider.addEventListener(
        "touchstart",
        function (e) {
          if (e.touches.length !== 1) return;
          startX = e.touches[0].clientX;
          isDragging = true;
        },
        { passive: true }
      );

      slider.addEventListener(
        "touchend",
        function (e) {
          if (!isDragging) return;
          const endX = e.changedTouches[0].clientX;
          const diffX = endX - startX;

          if (Math.abs(diffX) > SWIPE_THRESHOLD) {
            if (diffX < 0 && currentIndex < total - 1) {
              currentIndex++;
            } else if (diffX > 0 && currentIndex > 0) {
              currentIndex--;
            }
            updateSlide();
          }
          isDragging = false;
        },
        { passive: true }
      );

      // ===== PC용 마우스 드래그 (테스트용) =====
      let mouseDown = false;
      let mouseStartX = 0;

      slider.addEventListener("mousedown", function (e) {
        mouseDown = true;
        mouseStartX = e.clientX;
      });

      window.addEventListener("mouseup", function (e) {
        if (!mouseDown) return;
        const diffX = e.clientX - mouseStartX;

        if (Math.abs(diffX) > SWIPE_THRESHOLD) {
          if (diffX < 0 && currentIndex < total - 1) {
            currentIndex++;
          } else if (diffX > 0 && currentIndex > 0) {
            currentIndex--;
          }
          updateSlide();
        }
        mouseDown = false;
      });
    </script>
  </body>
</html>
